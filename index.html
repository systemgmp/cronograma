<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Implanta√ß√£o e Automa√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0052CC 0%, #00A86B 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid #0052CC;
            gap: 20px;
        }

        .header-logos {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .logo-gmp {
            height: 60px;
            width: auto;
            max-width: 150px;
        }

        .logo-futura {
            height: 50px;
            width: auto;
            max-width: 150px;
        }

        .header-title {
            flex: 1;
            text-align: center;
        }

        .header h1 {
            color: #0052CC;
            margin: 0 0 5px 0;
            font-size: 2.2em;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .header h1::before {
            
            font-size: 1.2em;
        }

        .header-subtitle {
            color: #00A86B;
            font-size: 1.1em;
            font-weight: 600;
            margin: 0;
        }

        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: linear-gradient(135deg, #0052CC 0%, #00A86B 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .info-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .info-card .value {
            font-size: 2em;
            font-weight: bold;
        }

        /* Progress Bar */
        .progress-section {
            margin-bottom: 30px;
        }

        .progress-section h2 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-bar-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 40px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0052CC 0%, #00A86B 100%);
            border-radius: 20px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .progress-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .color-realizado {
            background: #4caf50;
        }

        .color-no-prazo {
            background: #2196f3;
        }

        .color-ajustes {
            background: #ff9800;
        }

        .color-pendente {
            background: #e0e0e0;
        }

        /* Filters */
        .filters {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-group label {
            font-weight: 600;
            color: #0052CC;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.95em;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .filter-group select:hover,
        .filter-group input:hover,
        .filter-group select:focus,
        .filter-group input:focus {
            border-color: #0052CC;
            outline: none;
        }

        /* Grid de Widgets */
        .widgets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .widget {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #e0e0e0;
            cursor: pointer;
        }

        .widget.destaque {
            grid-column: span 2;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f7f4 100%);
            border: 3px solid #0052CC;
            border-left: 8px solid #00A86B;
            box-shadow: 0 15px 50px rgba(0, 82, 204, 0.3);
        }

        @media (max-width: 1024px) {
            .widget.destaque {
                grid-column: span 1;
            }
        }

        .widget:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .widget.destaque:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 82, 204, 0.4);
        }

        .widget.realizado {
            border-left-color: #4caf50;
        }

        .widget.no-prazo {
            border-left-color: #2196f3;
        }

        .widget.ajustes {
            border-left-color: #ff9800;
        }

        .widget.pendente {
            border-left-color: #e0e0e0;
        }

        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .widget-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
            flex: 1;
        }

        .widget-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            white-space: nowrap;
        }

        .widget-status.realizado {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .widget-status.no-prazo {
            background: #e3f2fd;
            color: #1565c0;
        }

        .widget-status.ajustes {
            background: #fff3e0;
            color: #e65100;
        }

        .widget-status.pendente {
            background: #f5f5f5;
            color: #666;
        }

        .status-icon {
            font-size: 1.2em;
        }

        .widget-content {
            margin-bottom: 15px;
        }

        .widget-content p {
            margin: 8px 0;
            color: #666;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .tarefas-list {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #0052CC;
        }

        .tarefas-list h4 {
            color: #0052CC;
            margin-bottom: 12px;
            font-size: 1em;
        }

        .tarefas-list ul {
            list-style: none;
            padding: 0;
        }

        .tarefas-list li {
            padding: 0;
            color: #555;
            font-size: 0.9em;
            border-bottom: none;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            list-style: none;
        }

        .tarefas-list li:last-child {
            border-bottom: none;
        }

        .tarefa-texto {
            flex: 1;
            word-break: break-word;
        }

        .tarefas-list li::before {
            content: "‚úì";
            color: #4caf50;
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .tarefa-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #0052CC;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .tarefa-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .tarefa-item:hover {
            background: #f5f7fa;
        }

        .tarefa-item.concluida {
            opacity: 0.6;
        }

        .tarefa-item.concluida .tarefa-texto {
            text-decoration: line-through;
            color: #999;
        }

        .widget-content strong {
            color: #333;
        }

        .widget-footer {
            border-top: 1px solid #e0e0e0;
            padding-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .widget-date {
            font-size: 0.85em;
            color: #999;
        }

        .status-buttons {
            display: flex;
            gap: 8px;
        }

        .status-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-btn.realizado {
            background: #4caf50;
            color: white;
        }

        .status-btn.no-prazo {
            background: #2196f3;
            color: white;
        }

        .status-btn.ajustes {
            background: #ff9800;
            color: white;
        }

        .status-btn.pendente {
            background: #e0e0e0;
            color: #666;
        }

        .status-btn:hover {
            opacity: 0.9;
            transform: scale(1.05);
        }

        /* Stats */
        .stats-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .stats-section h2 {
            color: #0052CC;
            margin-bottom: 25px;
            font-size: 1.5em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .stat-card.realizado {
            background: linear-gradient(135deg, #e8f5e9 0%, #a5d6a7 100%);
        }

        .stat-card.no-prazo {
            background: linear-gradient(135deg, #e3f2fd 0%, #90caf9 100%);
        }

        .stat-card.ajustes {
            background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 0.95em;
            color: #666;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .widgets-grid {
                grid-template-columns: 1fr;
            }

            .widget.destaque {
                grid-column: span 1 !important;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                flex-direction: column;
            }

            .filter-group select,
            .filter-group input {
                width: 100%;
            }
        }

        /* Anima√ß√µes */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .widget {
            animation: slideIn 0.5s ease-out;
        }

        /* Modal para detalhes */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 15px;
        }

        .modal-header h2 {
            color: #0052CC;
            margin: 0;
        }

        .close-btn {
            font-size: 2em;
            font-weight: bold;
            color: #999;
            cursor: pointer;
            border: none;
            background: none;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: #f0f0f0;
            color: #333;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-body p {
            margin: 12px 0;
            color: #666;
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95em;
        }

        .btn-primary {
            background: linear-gradient(135deg, #0052CC 0%, #00A86B 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 82, 204, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .save-controls {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
            z-index: 999;
        }

        .save-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .save-btn-primary {
            background: linear-gradient(135deg, #0052CC 0%, #00A86B 100%);
            color: white;
        }

        .save-btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 82, 204, 0.5);
        }

        .save-btn-pdf {
            background: linear-gradient(135deg, #E53935 0%, #D32F2F 100%);
            color: white;
        }

        .save-btn-pdf:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(229, 57, 53, 0.5);
        }

        .save-notification {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1001;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .save-notification.success {
            border-left: 4px solid #4caf50;
        }

        .save-notification.error {
            border-left: 4px solid #f44336;
        }

        .save-notification.success .notification-icon {
            color: #4caf50;
            font-size: 1.3em;
        }

        .save-notification.error .notification-icon {
            color: #f44336;
            font-size: 1.3em;
        }

        .notification-text {
            color: #333;
            font-weight: 600;
            font-size: 0.95em;
        }

        .save-status {
            position: fixed;
            bottom: 30px;
            left: 30px;
            padding: 12px 20px;
            border-radius: 50px;
            background: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            font-size: 0.9em;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 999;
        }

        .save-status.saved {
            color: #4caf50;
        }

        .save-status.unsaved {
            color: #ff9800;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-indicator.saved {
            background: #4caf50;
            animation: none;
        }

        .status-indicator.unsaved {
            background: #ff9800;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        @media (max-width: 768px) {
            .save-controls {
                bottom: 20px;
                right: 20px;
                flex-direction: column;
            }

            .save-notification {
                top: 20px;
                right: 20px;
                left: 20px;
            }

            .save-status {
                bottom: 20px;
                left: 20px;
            }
        }
    </style>
    <!-- Biblioteca para gerar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div class="header-logos">
                    <img src="https://i.ibb.co/d45YkXQf/logo-gmp.jpg" alt="Logo GMP" class="logo-gmp">
                </div>
                <div class="header-title">
                    <h1>Dashboard de Implanta√ß√£o e Automa√ß√£o</h1>
                    <p class="header-subtitle">FUTURA TINTAS</p>
                </div>
                <div class="header-logos">
                    <img src="https://i.ibb.co/GQhRSKqP/logo-futura.png" alt="Logo Futura Tintas" class="logo-futura">
                </div>
            </div>
            <div class="header-info">
                <div class="info-card">
                    <h3>M√°quinas Implantadas</h3>
                    <div class="value" id="totalMachines">0</div>
                </div>
                <div class="info-card">
                    <h3>Progresso Geral</h3>
                    <div class="value" id="totalProgress">0%</div>
                </div>
                <div class="info-card">
                    <h3>Data Atual</h3>
                    <div class="value" id="currentDate">--/--</div>
                </div>
                <div class="info-card">
                    <h3>Realizado</h3>
                    <div class="value" id="headerRealizado">0</div>
                </div>
                <div class="info-card">
                    <h3>No Prazo</h3>
                    <div class="value" id="headerNoPrazo">0</div>
                </div>
                <div class="info-card">
                    <h3>Ajustes</h3>
                    <div class="value" id="headerAjustes">0</div>
                </div>
                <div class="info-card">
                    <h3>Pendente</h3>
                    <div class="value" id="headerPendente">0</div>
                </div>
            </div>
        </div>

        <!-- Progress Section -->
        <div class="progress-section">
            <h2>üìä Progresso Geral do Projeto</h2>
            <div class="progress-bar-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%">0%</div>
                </div>
                <div class="progress-legend">
                    <div class="legend-item">
                        <div class="legend-color color-realizado"></div>
                        <span>Realizado</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color color-no-prazo"></div>
                        <span>No Prazo</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color color-ajustes"></div>
                        <span>Ajustes</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color color-pendente"></div>
                        <span>Pendente</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters -->
        <div class="filters">
            <div class="filter-group">
                <label>Filtrar por Status:</label>
                <select id="statusFilter">
                    <option value="">Todos</option>
                    <option value="realizado">Realizado</option>
                    <option value="no-prazo">No Prazo</option>
                    <option value="ajustes">Ajustes</option>
                    <option value="pendente">Pendente</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Filtrar por Fase:</label>
                <select id="phaseFilter">
                    <option value="">Todas as Fases</option>
                    <option value="FASE 1">Fase 1 - Piloto</option>
                    <option value="FASE 2">Fase 2 - Rollout Inicial</option>
                    <option value="FASE 3">Fase 3 - Manuten√ß√£o</option>
                    <option value="FASE 4">Fase 4 - Rollout Final</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Buscar M√°quina:</label>
                <input type="text" id="searchInput" placeholder="Ex: POL 16, POL 17...">
            </div>
        </div>

        <!-- Widgets Grid -->
        <div class="widgets-grid" id="widgetsContainer"></div>

        <!-- Stats Section -->
        <div class="stats-section">
            <h2>üìà Estat√≠sticas do Projeto</h2>
            <div class="stats-grid">
                <div class="stat-card realizado">
                    <div class="stat-number" id="statRealizado">0</div>
                    <div class="stat-label">Atividades Realizadas</div>
                </div>
                <div class="stat-card no-prazo">
                    <div class="stat-number" id="statNoPrazo">0</div>
                    <div class="stat-label">No Prazo</div>
                </div>
                <div class="stat-card ajustes">
                    <div class="stat-number" id="statAjustes">0</div>
                    <div class="stat-label">Com Ajustes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statPendente">0</div>
                    <div class="stat-label">Pendentes</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Controles de Salvamento -->
    <div class="save-controls">
        <button class="save-btn save-btn-pdf" onclick="exportToPDF()" title="Exportar para PDF">
            <span>üìÑ</span>
            <span>Gerar PDF</span>
        </button>
        <button class="save-btn save-btn-primary" onclick="saveData()" title="Salvar dados">
            <span>üíæ</span>
            <span>Salvar</span>
        </button>
    </div>

    <!-- Status de Salvamento -->
    <div class="save-status" id="saveStatus">
        <div class="status-indicator saved" id="statusIndicator"></div>
        <span id="statusText">Dados salvos</span>
    </div>

    <!-- Notificacao de Salvamento -->
    <div class="save-notification" id="saveNotification">
        <span class="notification-icon" id="notificationIcon">‚úì</span>
        <span class="notification-text" id="notificationText">Dados salvos com sucesso!</span>
    </div>

    <!-- Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Detalhes da Atividade</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Fechar</button>
                <button class="btn btn-primary" onclick="saveChanges()">Salvar Altera√ß√µes</button>
            </div>
        </div>
    </div>

    <script>
        // Dados do cronograma
        const cronogramaData = [
            // FASE 1 - Piloto
            {
                fase: "FASE 1",
                maquina: "POL 16",
                descricao: "Instala√ß√£o PLC, Configura√ß√£o e Testes a Frio",
                dataInicio: "24/11/2024",
                dataFim: "28/11/2024",
                acao: "SETUP & PILOTO",
                status: "pendente",
                destaque: true,
                detalhes: "Rodar lotes assistidos durante a semana. Validar todo o ciclo na m√°quina principal antes de escalar.",
                tarefas: [
                    "Prepara√ß√£o do ambiente de infraestrutura (servidores e banco de dados)",
                    "Instala√ß√£o do PLC na m√°quina POL 16",
                    "Configura√ß√£o do sistema de automa√ß√£o",
                    "Testes a frio (sem produ√ß√£o)",
                    "Rodar lotes assistidos durante a semana",
                    "Validar todo o ciclo na m√°quina principal antes de escalar",
                    "Testes de integra√ß√£o com sistema gerenciador",
                    "Documenta√ß√£o e treinamento inicial"
                ]
            },
            // FASE 2 - Rollout Inicial
            {
                fase: "FASE 2",
                maquina: "POL 16 - Maquina 180",
                descricao: "Produ√ß√£o Plena",
                dataInicio: "01/12/2024",
                dataFim: "01/12/2024",
                acao: "PRODU√á√ÉO",
                status: "pendente",
                detalhes: "In√≠cio da produ√ß√£o plena com sistema implantado."
            },
            {
                fase: "FASE 2",
                maquina: "POL 17 - Maquina 180",
                descricao: "Setup / Instala√ß√£o",
                dataInicio: "01/12/2024",
                dataFim: "01/12/2024",
                acao: "SETUP",
                status: "pendente",
                detalhes: "Instala√ß√£o do sistema na m√°quina POL 17."
            },
            {
                fase: "FASE 2",
                maquina: "POL 17 - Maquina 180",
                descricao: "Acompanhamento Assistido",
                dataInicio: "02/12/2024",
                dataFim: "03/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "2 dias de acompanhamento t√©cnico assistido."
            },
            {
                fase: "FASE 2",
                maquina: "POL 17 & 18 - Maquina 180",
                descricao: "PARADA CR√çTICA (Tanque Compartilhado)",
                dataInicio: "04/12/2024",
                dataFim: "04/12/2024",
                acao: "PARADA",
                status: "pendente",
                detalhes: "Setup da POL 18 e ajustes de integra√ß√£o."
            },
            {
                fase: "FASE 2",
                maquina: "POL 18 - Maquina 180",
                descricao: "Acompanhamento Assistido",
                dataInicio: "05/12/2024",
                dataFim: "09/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "3 dias de acompanhamento t√©cnico assistido."
            },
            {
                fase: "FASE 2",
                maquina: "POL 13 - Maquina 30",
                descricao: "Setup (Pequeno Volume)",
                dataInicio: "10/12/2024",
                dataFim: "10/12/2024",
                acao: "SETUP",
                status: "pendente",
                detalhes: "Instala√ß√£o do sistema em m√°quina de pequeno volume."
            },
            {
                fase: "FASE 2",
                maquina: "POL 13 / POL 14  - Maquina 30 e 60",
                descricao: "Acompanhamento / Setup POL 14",
                dataInicio: "11/12/2024",
                dataFim: "11/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 13 e setup da POL 14."
            },
            {
                fase: "FASE 2",
                maquina: "POL 14 / POL 15 - Maquina 60 e 110 ",
                descricao: "Acompanhamento / Setup POL 15",
                dataInicio: "12/12/2024",
                dataFim: "12/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 14 e setup da POL 15."
            },
            {
                fase: "FASE 2",
                maquina: "POL 15 - Maquina 110",
                descricao: "Acompanhamento",
                dataInicio: "15/12/2024",
                dataFim: "15/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento t√©cnico da POL 15."
            },
            {
                fase: "FASE 2",
                maquina: "POL 11 - Maquina 555",
                descricao: "Setup (M√°quina 555)",
                dataInicio: "16/12/2024",
                dataFim: "16/12/2024",
                acao: "SETUP",
                status: "pendente",
                detalhes: "Instala√ß√£o do sistema na m√°quina POL 11 (555)."
            },
            {
                fase: "FASE 2",
                maquina: "POL 11 / POL 12  - Maquina 555",
                descricao: "Acompanhamento / Setup POL 12",
                dataInicio: "17/12/2024",
                dataFim: "17/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 11 e setup da POL 12."
            },
            {
                fase: "FASE 2",
                maquina: "POL 12 - Maquina 555",
                descricao: "Acompanhamento (M√°quina 555)",
                dataInicio: "18/12/2024",
                dataFim: "18/12/2024",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento t√©cnico da POL 12."
            },
            {
                fase: "FASE 2",
                maquina: "GERAL",
                descricao: "Revis√£o Geral das 8 M√°quinas",
                dataInicio: "19/12/2024",
                dataFim: "19/12/2024",
                acao: "REVIS√ÉO",
                status: "pendente",
                detalhes: "Revis√£o geral de todas as 8 m√°quinas implantadas."
            },
            // FASE 3 - Manuten√ß√£o
            {
                fase: "FASE 3",
                maquina: "GERAL",
                descricao: "Plant√£o T√©cnico",
                dataInicio: "22/12/2024",
                dataFim: "23/12/2024",
                acao: "PLANT√ÉO",
                status: "pendente",
                detalhes: "Monitoramento, ajustes finos de software e corre√ß√µes. Sem novas implanta√ß√µes."
            },
            {
                fase: "FASE 3",
                maquina: "GERAL",
                descricao: "Parada de Natal",
                dataInicio: "24/12/2024",
                dataFim: "26/12/2024",
                acao: "PARADA",
                status: "pendente",
                detalhes: "F√°brica parada para recesso de Natal."
            },
            {
                fase: "FASE 3",
                maquina: "GERAL",
                descricao: "Plant√£o T√©cnico",
                dataInicio: "29/12/2024",
                dataFim: "30/12/2024",
                acao: "PLANT√ÉO",
                status: "pendente",
                detalhes: "Monitoramento e prepara√ß√£o para retomada em Janeiro."
            },
            {
                fase: "FASE 3",
                maquina: "GERAL",
                descricao: "Parada de Ano Novo",
                dataInicio: "31/12/2024",
                dataFim: "02/01/2025",
                acao: "PARADA",
                status: "pendente",
                detalhes: "F√°brica parada para recesso de Ano Novo."
            },
            // FASE 4 - Rollout Final
            {
                fase: "FASE 4",
                maquina: "POL 19 - Maquina Massa",
                descricao: "Setup (Massa)",
                dataInicio: "05/01/2025",
                dataFim: "05/01/2025",
                acao: "SETUP",
                status: "pendente",
                detalhes: "Instala√ß√£o do sistema na m√°quina POL 19 (Massa)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 19 / POL 20 - Maquina Massa e Textura",
                descricao: "Acompanhamento / Setup POL 20",
                dataInicio: "06/01/2025",
                dataFim: "06/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 19 e setup da POL 20 (Textura)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 20 / POL 06 - Maquina Textura e Titanio",
                descricao: "Acompanhamento / Setup POL 06",
                dataInicio: "07/01/2025",
                dataFim: "07/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 20 e setup da POL 06 (Tit√¢nio)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 06 / POL 04 - Maquina Titani e Amarelo",
                descricao: "Acompanhamento / Setup POL 04",
                dataInicio: "08/01/2025",
                dataFim: "08/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 06 e setup da POL 04 (Amarelo)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 04 - Maquina Amarelo",
                descricao: "Acompanhamento",
                dataInicio: "09/01/2025",
                dataFim: "09/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento t√©cnico final da POL 04."
            },
            {
                fase: "FASE 4",
                maquina: "POL 07 - Maquina BASE",
                descricao: "Setup (Base)",
                dataInicio: "12/01/2025",
                dataFim: "12/01/2025",
                acao: "SETUP",
                status: "pendente",
                detalhes: "Instala√ß√£o do sistema na m√°quina POL 07 (Base)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 07 / POL 08 - Maquina BASE",
                descricao: "Acompanhamento / Setup POL 08",
                dataInicio: "13/01/2025",
                dataFim: "13/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 07 e setup da POL 08 (Base)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 08 / POL 21 - Maquina BASE e MH140",
                descricao: "Acompanhamento / Setup POL 21",
                dataInicio: "14/01/2025",
                dataFim: "14/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 08 e setup da POL 21 (MH 140)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 21 / POL 22",
                descricao: "Acompanhamento / Setup POL 22 - Maquina MH 140 e 280",
                dataInicio: "15/01/2025",
                dataFim: "15/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento POL 21 e setup da POL 22 (MH 280)."
            },
            {
                fase: "FASE 4",
                maquina: "POL 22 - Maquina MH 280",
                descricao: "Acompanhamento Final",
                dataInicio: "16/01/2025",
                dataFim: "16/01/2025",
                acao: "ACOMPANHAMENTO",
                status: "pendente",
                detalhes: "Acompanhamento t√©cnico final da POL 22."
            },
            {
                fase: "FASE 4",
                maquina: "GERAL",
                descricao: "Entrega Final e Encerramento",
                dataInicio: "19/01/2025",
                dataFim: "19/01/2025",
                acao: "ENCERRAMENTO",
                status: "pendente",
                detalhes: "Entrega final do projeto e encerramento oficial."
            }
        ];

        let allData = [...cronogramaData];
        let currentFilter = { status: '', phase: '', search: '' };
        let tarefasCompletas = {}; // Armazenar tarefas marcadas como conclu√≠das

        // Inicializar dashboard
        function initDashboard() {
            updateCurrentDate();
            renderWidgets(allData);
            updateStats();
            updateProgress();
            setupEventListeners();
        }

        // Atualizar data atual
        function updateCurrentDate() {
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0');
            const month = String(today.getMonth() + 1).padStart(2, '0');
            document.getElementById('currentDate').textContent = `${day}/${month}`;
        }

        // Renderizar widgets
        function renderWidgets(data) {
            const container = document.getElementById('widgetsContainer');
            container.innerHTML = '';

            if (data.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: white; font-size: 1.2em;">Nenhuma atividade encontrada com os filtros selecionados.</p>';
                return;
            }

            data.forEach((item, index) => {
                const widget = createWidget(item, index);
                container.appendChild(widget);
            });
        }

        // Criar widget
        function createWidget(item, index) {
            const widget = document.createElement('div');
            widget.className = `widget ${item.status}${item.destaque ? ' destaque' : ''}`;
            widget.style.animationDelay = `${index * 0.05}s`;

            const statusIcons = {
                realizado: '‚úì',
                'no-prazo': '‚è±',
                ajustes: '‚öô',
                pendente: '‚óã'
            };

            const statusLabels = {
                realizado: 'Realizado',
                'no-prazo': 'No Prazo',
                ajustes: 'Ajustes',
                pendente: 'Pendente'
            };

            let tarefasHTML = '';
            if (item.tarefas && item.tarefas.length > 0) {
                const tarefasItems = item.tarefas.map((tarefa, idx) => `
                    <li class="tarefa-item" id="tarefa-${index}-${idx}">
                        <input type="checkbox" class="tarefa-checkbox" onchange="toggleTarefa(${index}, ${idx}, this)">
                        <span class="tarefa-texto">${tarefa}</span>
                    </li>
                `).join('');
                tarefasHTML = `
                    <div class="tarefas-list">
                        <h4>üìã Tarefas a Realizar:</h4>
                        <ul>
                            ${tarefasItems}
                        </ul>
                    </div>
                `;
            }

            widget.innerHTML = `
                <div class="widget-header">
                    <div class="widget-title">${item.maquina}</div>
                    <div class="widget-status ${item.status}">
                        <span class="status-icon">${statusIcons[item.status]}</span>
                        <span>${statusLabels[item.status]}</span>
                    </div>
                </div>
                <div class="widget-content">
                    <p><strong>Fase:</strong> ${item.fase}</p>
                    <p><strong>Atividade:</strong> ${item.descricao}</p>
                    <p><strong>Per√≠odo:</strong> ${item.dataInicio} a ${item.dataFim}</p>
                    <p><strong>A√ß√£o:</strong> ${item.acao}</p>
                    ${tarefasHTML}
                </div>
                <div class="widget-footer">
                    <span class="widget-date">${item.dataInicio}</span>
                    <div class="status-buttons">
                        <button class="status-btn realizado" onclick="updateStatus(${index}, 'realizado')">‚úì</button>
                        <button class="status-btn no-prazo" onclick="updateStatus(${index}, 'no-prazo')">‚è±</button>
                        <button class="status-btn ajustes" onclick="updateStatus(${index}, 'ajustes')">‚öô</button>
                    </div>
                </div>
            `;

            widget.onclick = (e) => {
                if (!e.target.classList.contains('status-btn')) {
                    openModal(item);
                }
            };

            return widget;
        }

        // Atualizar status
        function updateStatus(index, newStatus) {
            allData[index].status = newStatus;
            renderWidgets(filterData());
            updateStats();
            updateProgress();
            markAsUnsaved();
        }

        // Filtrar dados
        function filterData() {
            return allData.filter(item => {
                const statusMatch = !currentFilter.status || item.status === currentFilter.status;
                const phaseMatch = !currentFilter.phase || item.fase === currentFilter.phase;
                const searchMatch = !currentFilter.search || 
                    item.maquina.toLowerCase().includes(currentFilter.search.toLowerCase()) ||
                    item.descricao.toLowerCase().includes(currentFilter.search.toLowerCase());
                
                return statusMatch && phaseMatch && searchMatch;
            });
        }

        // Atualizar estat√≠sticas
        function updateStats() {
            const realizado = allData.filter(d => d.status === 'realizado').length;
            const noPrazo = allData.filter(d => d.status === 'no-prazo').length;
            const ajustes = allData.filter(d => d.status === 'ajustes').length;
            const pendente = allData.filter(d => d.status === 'pendente').length;

            // Atualizar contadores na se√ß√£o de estat√≠sticas
            document.getElementById('statRealizado').textContent = realizado;
            document.getElementById('statNoPrazo').textContent = noPrazo;
            document.getElementById('statAjustes').textContent = ajustes;
            document.getElementById('statPendente').textContent = pendente;
            
            // Atualizar contadores no header
            document.getElementById('headerRealizado').textContent = realizado;
            document.getElementById('headerNoPrazo').textContent = noPrazo;
            document.getElementById('headerAjustes').textContent = ajustes;
            document.getElementById('headerPendente').textContent = pendente;
            
            // Contar m√°quinas √∫nicas (lista fixa de 16 m√°quinas)
            const machinesTotal = 16;
            document.getElementById('totalMachines').textContent = machinesTotal;
        }

        // Atualizar progresso
        function updateProgress() {
            const total = allData.length;
            const realizado = allData.filter(d => d.status === 'realizado').length;
            const noPrazo = allData.filter(d => d.status === 'no-prazo').length;
            const completed = realizado + noPrazo;
            const percentage = Math.round((completed / total) * 100);

            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = percentage + '%';
            progressFill.textContent = percentage + '%';
            document.getElementById('totalProgress').textContent = percentage + '%';
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('statusFilter').addEventListener('change', (e) => {
                currentFilter.status = e.target.value;
                renderWidgets(filterData());
            });

            document.getElementById('phaseFilter').addEventListener('change', (e) => {
                currentFilter.phase = e.target.value;
                renderWidgets(filterData());
            });

            document.getElementById('searchInput').addEventListener('input', (e) => {
                currentFilter.search = e.target.value;
                renderWidgets(filterData());
            });

            window.addEventListener('click', (e) => {
                const modal = document.getElementById('detailModal');
                if (e.target === modal) {
                    closeModal();
                }
            });
        }

        // Abrir modal
        function openModal(item) {
            const modal = document.getElementById('detailModal');
            document.getElementById('modalTitle').textContent = `${item.maquina} - ${item.descricao}`;
            
            let tarefasHTML = '';
            if (item.tarefas && item.tarefas.length > 0) {
                const tarefasItems = item.tarefas.map(tarefa => `<li style="padding: 8px 0; color: #555; display: flex; align-items: flex-start; gap: 10px;"><span style="color: #4caf50; font-weight: bold; margin-top: 2px;">‚úì</span> ${tarefa}</li>`).join('');
                tarefasHTML = `<hr style="margin: 15px 0; border: none; border-top: 1px solid #e0e0e0;"><h3 style="color: #667eea; margin-top: 15px; margin-bottom: 10px;">Tarefas a Realizar:</h3><ul style="list-style: none; padding-left: 0;">${tarefasItems}</ul>`;
            }
            
            document.getElementById('modalBody').innerHTML = `
                <p><strong>Fase:</strong> ${item.fase}</p>
                <p><strong>Atividade:</strong> ${item.descricao}</p>
                <p><strong>Per√≠odo:</strong> ${item.dataInicio} a ${item.dataFim}</p>
                <p><strong>A√ß√£o:</strong> ${item.acao}</p>
                <p><strong>Detalhes:</strong> ${item.detalhes}</p>
                <p><strong>Status Atual:</strong> <span style="color: #667eea; font-weight: bold;">${item.status.toUpperCase()}</span></p>
                ${tarefasHTML}
            `;
            modal.style.display = 'block';
        }

        // Toggle tarefa
        function toggleTarefa(itemIndex, tarefaIdx, checkbox) {
            const key = itemIndex + '-' + tarefaIdx;
            const tarefaItem = document.getElementById('tarefa-' + key);
            
            if (checkbox.checked) {
                tarefasCompletas[key] = true;
                tarefaItem.classList.add('concluida');
            } else {
                delete tarefasCompletas[key];
                tarefaItem.classList.remove('concluida');
            }
            
            markAsUnsaved();
        }

        // Fechar modal
        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // Salvar altera√ß√µes
        function saveChanges() {
            closeModal();
            saveData();
        }

        // Salvar dados no localStorage
        function saveData() {
            try {
                const dataToSave = {
                    activities: allData.map(item => ({
                        maquina: item.maquina,
                        status: item.status
                    })),
                    tarefas: tarefasCompletas,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('cronogramaDashboard', JSON.stringify(dataToSave));
                showSaveNotification('Dados salvos com sucesso!', 'success');
                updateSaveStatus('saved');
            } catch (error) {
                console.error('Erro ao salvar dados:', error);
                showSaveNotification('Erro ao salvar dados!', 'error');
                updateSaveStatus('unsaved');
            }
        }

        // Carregar dados do localStorage
        function loadData() {
            try {
                const saved = localStorage.getItem('cronogramaDashboard');
                if (saved) {
                    const data = JSON.parse(saved);
                    
                    // Restaurar status das atividades
                    if (data.activities) {
                        data.activities.forEach(savedItem => {
                            const item = allData.find(d => d.maquina === savedItem.maquina);
                            if (item) {
                                item.status = savedItem.status;
                            }
                        });
                    }
                    
                    // Restaurar tarefas conclu√≠das
                    if (data.tarefas) {
                        tarefasCompletas = data.tarefas;
                    }
                    
                    console.log('Dados carregados do localStorage');
                    return true;
                }
                return false;
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                return false;
            }
        }

        // Mostrar notifica√ß√£o de salvamento
        function showSaveNotification(message, type) {
            const notification = document.getElementById('saveNotification');
            const icon = document.getElementById('notificationIcon');
            const text = document.getElementById('notificationText');
            
            notification.className = 'save-notification ' + type;
            icon.textContent = type === 'success' ? '‚úì' : '‚úó';
            text.textContent = message;
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Atualizar status de salvamento
        function updateSaveStatus(status) {
            const statusDiv = document.getElementById('saveStatus');
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            statusDiv.classList.remove('saved', 'unsaved');
            indicator.classList.remove('saved', 'unsaved');
            
            if (status === 'saved') {
                statusDiv.classList.add('saved');
                indicator.classList.add('saved');
                statusText.textContent = 'Dados salvos';
            } else {
                statusDiv.classList.add('unsaved');
                indicator.classList.add('unsaved');
                statusText.textContent = 'Altera√ß√µes n√£o salvas';
            }
        }

        // Detectar altera√ß√µes
        function markAsUnsaved() {
            updateSaveStatus('unsaved');
        }

        // Exportar para PDF
        function exportToPDF() {
            // Ocultar bot√µes de salvamento durante a gera√ß√£o do PDF
            const saveControls = document.querySelector('.save-controls');
            const saveStatus = document.querySelector('.save-status');
            const saveNotification = document.querySelector('.save-notification');
            
            saveControls.style.display = 'none';
            saveStatus.style.display = 'none';
            saveNotification.style.display = 'none';
            
            // Ocultar checkboxes e bot√µes de status
            const checkboxes = document.querySelectorAll('.tarefa-checkbox');
            const statusButtons = document.querySelectorAll('.status-buttons');
            
            checkboxes.forEach(cb => cb.style.display = 'none');
            statusButtons.forEach(sb => sb.style.display = 'none');
            
            showSaveNotification('Gerando PDF...', 'success');
            
            // Configura√ß√µes do PDF
            const element = document.querySelector('.container');
            const opt = {
                margin: [10, 10, 10, 10],
                filename: 'Cronograma_Implantacao_Futura_Tintas.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait'
                },
                pagebreak: { 
                    mode: ['avoid-all', 'css', 'legacy']
                }
            };
            
            // Gerar PDF
            html2pdf().set(opt).from(element).save().then(() => {
                // Restaurar elementos ocultos
                saveControls.style.display = 'flex';
                saveStatus.style.display = 'flex';
                checkboxes.forEach(cb => cb.style.display = 'block');
                statusButtons.forEach(sb => sb.style.display = 'flex');
                
                showSaveNotification('PDF gerado com sucesso!', 'success');
            }).catch(error => {
                // Restaurar elementos em caso de erro
                saveControls.style.display = 'flex';
                saveStatus.style.display = 'flex';
                checkboxes.forEach(cb => cb.style.display = 'block');
                statusButtons.forEach(sb => sb.style.display = 'flex');
                
                console.error('Erro ao gerar PDF:', error);
                showSaveNotification('Erro ao gerar PDF!', 'error');
            });
        }

        // Iniciar dashboard
        initDashboard();
        
        // Carregar dados salvos
        if (loadData()) {
            renderWidgets(filterData());
            updateStats();
            updateProgress();
            updateSaveStatus('saved');
        } else {
            updateSaveStatus('saved');
        }

        // Salvar automaticamente a cada 30 segundos se houver altera√ß√µes
        setInterval(() => {
            if (document.getElementById('saveStatus').classList.contains('unsaved')) {
                saveData();
            }
        }, 30000);

        // Salvar ao fechar a p√°gina
        window.addEventListener('beforeunload', (e) => {
            if (document.getElementById('saveStatus').classList.contains('unsaved')) {
                saveData();
            }
        });
    </script>
</body>
</html>